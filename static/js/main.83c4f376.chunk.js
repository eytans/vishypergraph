(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{135:function(e,t,n){e.exports=n(290)},140:function(e,t,n){},141:function(e,t,n){},290:function(e,t,n){"use strict";n.r(t);var i=n(0),r=n.n(i),o=n(125),s=n.n(o),a=(n(140),n(13)),l=n(18),c=n(47),u=n(44),d=n(46),h=(n(141),n(292)),p=n(293),v=n(131),f=n(295),g=n(294),y=n(133),m=n(134),x=n(126),b=n(127),w=n.n(b),j=function(){function e(t,n){Object(a.a)(this,e),this.id=void 0,this.label=void 0,this.id=t,this.label=n}return Object(l.a)(e,[{key:"toString",value:function(){return null==this.label?this.id.toString():this.label}}]),e}(),k=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ellipse",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#80b3ff";Object(a.a)(this,e),this.id=void 0,this.literal=void 0,this.shape=void 0,this.color=void 0,this.id=t,this.literal=n,this.shape=i,this.color=r}return Object(l.a)(e,[{key:"toVisNode",value:function(){return{id:this.id.id,shape:this.shape,label:void 0!==this.literal?this.literal:this.id.toString(),color:this.color}}}]),e}(),O=function e(t,n){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(a.a)(this,e),this.type=void 0,this.sources=void 0,this.hasTarget=void 0,this.type=t,this.sources=n,this.hasTarget=i},E={hasTarget:!0,layout:{hierarchical:!1},edges:{color:"#000000"},nodes:{margin:10}},T=function(e){function t(e){var n;Object(a.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).options=void 0,n.hasTarget=void 0,n.events={select:function(e){e.nodes,e.edges}},n.handleResize=function(){console.log("Trying rerender"),n.forceUpdate()};var i=Object(m.a)({},E,e.options),r=i.hasTarget,o=Object(x.a)(i,["hasTarget"]);return n.hasTarget=r,n.options=o,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this;console.log("rendering hyper graph");var t=Math.max.apply(Math,Object(y.a)(this.props.nodes.map(function(e){return e.id.id}))),n=this.props.nodes.map(function(e,t,n){return e.toVisNode()}),i=[],o=!0,s=!1,a=void 0;try{for(var l,c=function(){var r=l.value,o=new k(new j(t+=1),r.type,"box","#88cc00");n.push(o.toVisNode()),i=i.concat(r.sources.map(function(t,n){return e.hasTarget&&r.hasTarget&&0===n?{to:t.id,from:o.id.id}:e.hasTarget&&r.hasTarget?{from:t.id,to:o.id.id,label:"arg "+n}:{from:t.id,to:o.id.id,label:"arg "+(n+1)}}))},u=this.props.edges[Symbol.iterator]();!(o=(l=u.next()).done);o=!0)c()}catch(h){s=!0,a=h}finally{try{o||null==u.return||u.return()}finally{if(s)throw a}}var d={nodes:n,edges:i};return console.log("returning new hyper graph"),r.a.createElement(w.a,{graph:d,options:this.options,events:this.events})}}]),t}(i.Component),I=n(128),R=n(129),H=n.n(R),z=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).textRef=void 0,n.handleResize=function(){console.log("Trying rerender"),n.forceUpdate()},n.textRef=r.a.createRef(),n.state={nodes:[],edges:[]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"parseText",value:function(e,t){var n=Object(I.generate)('\n    expression = exp:smallerexpression "{" exps:expressionlist "}" { return {type: \'tree\', root:exp, subtrees: exps} } \n    / smallerexpression\n    \n    smallerexpression = root:identifier _ "(" exps:expressionlist ")" {\n      var res = {type: \'node\'};\n      res[root[\'value\']] = exps;\n      return  res;\n    }\n    / number\n    / identifier\n    / literal\n    \n    expressionlist =  _ exp:expression? exps:( _ "," _ expression _ )* {\n        if (exp === null) return [];\n        else if (exps.length === 0) return exp;\n        else return [exp].concat(exps.map(function(a){ return a[3] }))\n      }\n    \n    identifier = lets:([^(),"])+ {return {type: \'identifier\', value:lets.join("")}}\n    \n    number = digits:[0-9]+ {return {type: \'number\', value:parseInt(digits.join(""), 10)}}\n    \n    literal = \'"\' lets:(!\'"\' .)* \'"\' {return {type: \'literal\', value: lets.map(x => x[1]).join("")}}\n    \n    _  = [ \\t\\r\\n]*'),i=new H.a(e),r=null;try{r=n.parse(e,{tracer:i})}catch(o){console.log(o),console.log(i.getBacktraceString())}return console.log(r),r}},{key:"handleClick",value:function(e){var n=this.textRef.current.value;if("string"===typeof n){var i=this.parseText(n),r=t.getEdges(i).map(function(e){return t.parseEdge(e)}),o=new Map(r.flatMap(function(e){return console.log(e.sources),e.sources.map(function(e){return[e.id,new k(e)]})}));this.setState({nodes:Array.from(o.values()),edges:r})}}},{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return console.log("rendering app"),r.a.createElement(h.a,{style:{height:"100vh",minHeight:"100vh"}},r.a.createElement(p.a,null,r.a.createElement(v.a,null,r.a.createElement(f.a,{onClick:this.handleClick.bind(this)},"Draw Graph!"),r.a.createElement(g.a.Control,{ref:this.textRef,style:{width:"75vh"},type:"text",placeholder:"Enter hyper graph text"}))),r.a.createElement(p.a,{style:{height:"100%"}},r.a.createElement(T,{edges:this.state.edges,nodes:this.state.nodes})))}}],[{key:"getEdges",value:function(e){var t=Object.keys(e).find(function(e){return e.toLowerCase().includes("hypergraph")});if(void 0===t)throw new Error("bla");return console.log(t),Array.isArray(e[t].Set)?e[t].Set.map(function(e){return e.HyperEdge}):[e[t].Set.HyperEdge]}},{key:"extractId",value:function(e){var t=null,n=-9999;if(Object.keys(e).includes("Explicit"))n=e.Explicit.HyperTermId.value,t="Explicit";else if(Object.keys(e).includes("Hole"))n=-e.Hole.value,t="Hole";else if(Object.keys(e).includes("Ignore"))t="Ignore";else if(Object.keys(e).includes("Repetition"))n=e.Repetition[1].value,t="Repetition";else{if(!Object.keys(e).includes("Stream"))return new j(e.HyperTermId.value);n=e.Repetition[1].value,t="Repetition"}return new j(n,t+"("+n+")")}},{key:"extractIdentifier",value:function(e){return Object.keys(e).includes("Explicit")?e.Explicit.HyperTermIdentifier.Identifier[0].value:Object.keys(e).includes("Hole")?"Hole("+e.Hole.value+")":Object.keys(e).includes("Ignore")?"Ignore":e.HyperTermIdentifier.Identifier[0].value}},{key:"parseEdge",value:function(e){var n=t.extractIdentifier(e[1]),i=[t.extractId(e[0])],r=e[2].List;return r=void 0===r?[]:Array.isArray(r)?r.map(t.extractId):[t.extractId(r)],"type"===n?new O(n,r,!1):new O(n,i.concat(r))}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[135,1,2]]]);
//# sourceMappingURL=main.83c4f376.chunk.js.map