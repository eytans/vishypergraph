(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{135:function(e,t,n){e.exports=n(290)},140:function(e,t,n){},141:function(e,t,n){},290:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n.n(r),o=n(125),s=n.n(o),a=(n(140),n(13)),l=n(18),c=n(47),u=n(44),d=n(46),h=(n(141),n(292)),p=n(293),v=n(131),f=n(295),g=n(294),y=n(133),m=n(134),b=n(126),x=n(127),w=n.n(x),k=function(){function e(t,n){Object(a.a)(this,e),this.id=void 0,this.label=void 0,this.id=t,this.label=n}return Object(l.a)(e,[{key:"toString",value:function(){return null==this.label?this.id.toString():this.label}}]),e}(),j=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ellipse",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{background:"#80b3ff",border:"black"};Object(a.a)(this,e),this.id=void 0,this.literal=void 0,this.shape=void 0,this.color=void 0,this.id=t,this.literal=n,this.shape=r,this.color=i}return Object(l.a)(e,[{key:"toVisNode",value:function(){return{id:this.id.id,shape:this.shape,label:void 0!==this.literal?this.literal:this.id.toString(),color:this.color}}}]),e}(),O=function e(t,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Object(a.a)(this,e),this.type=void 0,this.sources=void 0,this.hasTarget=void 0,this.type=t,this.sources=n,this.hasTarget=r},E={hasTarget:!0,layout:{hierarchical:!1},edges:{color:"#000000"},nodes:{margin:10}},T=function(e){function t(e){var n;Object(a.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).options=void 0,n.hasTarget=void 0,n.events={select:function(e){e.nodes,e.edges}},n.handleResize=function(){console.log("Trying rerender"),n.forceUpdate()};var r=Object(m.a)({},E,e.options),i=r.hasTarget,o=Object(b.a)(r,["hasTarget"]);return n.hasTarget=i,n.options=o,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this;console.log("rendering hyper graph");var t=Math.max.apply(Math,Object(y.a)(this.props.nodes.map(function(e){return e.id.id}))),n=this.props.nodes.map(function(e,t,n){return e.toVisNode()}),r=[],o=!0,s=!1,a=void 0;try{for(var l,c=function(){var i=l.value;t+=1;var o="#88cc00";console.log(i.sources.length),1===i.sources.length&&(o="pink"),1===i.sources.length&&i.type.toLowerCase().includes("anchor")&&(o="thistle"),console.log(o);var s=new j(new k(t),i.type,"box",{background:o,border:"black"});n.push(s.toVisNode()),r=r.concat(i.sources.map(function(t,n){return e.hasTarget&&i.hasTarget&&0===n?{to:t.id,from:s.id.id,color:o}:e.hasTarget&&i.hasTarget?{from:t.id,to:s.id.id,label:"arg "+n,color:o}:{from:t.id,to:s.id.id,label:"arg "+(n+1),color:o}}))},u=this.props.edges[Symbol.iterator]();!(o=(l=u.next()).done);o=!0)c()}catch(h){s=!0,a=h}finally{try{o||null==u.return||u.return()}finally{if(s)throw a}}var d={nodes:n,edges:r};return console.log("returning new hyper graph"),i.a.createElement(w.a,{graph:d,options:this.options,events:this.events})}}]),t}(r.Component),I=n(128),R=n(129),H=n.n(R),z=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).textRef=void 0,n.handleResize=function(){console.log("Trying rerender"),n.forceUpdate()},n.textRef=i.a.createRef(),n.state={nodes:[],edges:[]},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"parseText",value:function(e,t){var n=Object(I.generate)('\n    expression = exp:smallerexpression "{" exps:expressionlist "}" { return {type: \'tree\', root:exp, subtrees: exps} } \n    / smallerexpression\n    \n    smallerexpression = root:identifier _ "(" exps:expressionlist ")" {\n      var res = {type: \'node\'};\n      res[root[\'value\']] = exps;\n      return  res;\n    }\n    / number\n    / identifier\n    / literal\n    \n    expressionlist =  _ exp:expression? exps:( _ "," _ expression _ )* {\n        if (exp === null) return [];\n        else if (exps.length === 0) return exp;\n        else return [exp].concat(exps.map(function(a){ return a[3] }))\n      }\n    \n    identifier = lets:([^(),"])+ {return {type: \'identifier\', value:lets.join("")}}\n    \n    number = digits:[0-9]+ {return {type: \'number\', value:parseInt(digits.join(""), 10)}}\n    \n    literal = \'"\' lets:(!\'"\' .)* \'"\' {return {type: \'literal\', value: lets.map(x => x[1]).join("")}}\n    \n    _  = [ \\t\\r\\n]*'),r=new H.a(e),i=null;try{i=n.parse(e,{tracer:r})}catch(o){console.log(o),console.log(r.getBacktraceString())}return console.log(i),i}},{key:"handleClick",value:function(e){var n=this.textRef.current.value;if("string"===typeof n){var r=this.parseText(n),i=t.getEdges(r).map(function(e){return t.parseEdge(e)}),o=new Map(i.flatMap(function(e){return console.log(e.sources),e.sources.map(function(e){return[e.id,new j(e)]})}));this.setState({nodes:Array.from(o.values()),edges:i})}}},{key:"componentDidMount",value:function(){this.handleResize(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){return console.log("rendering app"),i.a.createElement(h.a,{style:{height:"100vh",minHeight:"100vh"}},i.a.createElement(p.a,null,i.a.createElement(v.a,null,i.a.createElement(f.a,{onClick:this.handleClick.bind(this)},"Draw Graph!"),i.a.createElement(g.a.Control,{ref:this.textRef,style:{width:"75vh"},type:"text",placeholder:"Enter hyper graph text"}))),i.a.createElement(p.a,{style:{height:"100%"}},i.a.createElement(T,{edges:this.state.edges,nodes:this.state.nodes})))}}],[{key:"getEdges",value:function(e){var t=Object.keys(e).find(function(e){return e.toLowerCase().includes("hypergraph")});if(void 0===t)throw new Error("bla");return console.log(t),Array.isArray(e[t].Set)?e[t].Set.map(function(e){return e.HyperEdge}):[e[t].Set.HyperEdge]}},{key:"extractId",value:function(e){var t=null,n=-9999;if(Object.keys(e).includes("Explicit"))n=e.Explicit.HyperTermId.value,t="Explicit";else if(Object.keys(e).includes("Hole"))n=-e.Hole.value,t="Hole";else if(Object.keys(e).includes("Ignore"))t="Ignore";else if(Object.keys(e).includes("Repetition"))n=e.Repetition[1].value,t="Repetition";else{if(!Object.keys(e).includes("Stream"))return new k(e.HyperTermId.value);n=e.Repetition[1].value,t="Repetition"}return new k(n,t+"("+n+")")}},{key:"extractIdentifier",value:function(e){return Object.keys(e).includes("Explicit")?e.Explicit.HyperTermIdentifier.Identifier[0].value:Object.keys(e).includes("Hole")?"Hole("+e.Hole.value+")":Object.keys(e).includes("Ignore")?"Ignore":e.HyperTermIdentifier.Identifier[0].value}},{key:"parseEdge",value:function(e){var n=t.extractIdentifier(e[1]),r=[t.extractId(e[0])],i=e[2].List;return i=void 0===i?[]:Array.isArray(i)?i.map(t.extractId):[t.extractId(i)],["type","spacecomplex","timecomplex"].includes(n)?new O(n,i,!1):new O(n,r.concat(i))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[135,1,2]]]);
//# sourceMappingURL=main.5c59c569.chunk.js.map